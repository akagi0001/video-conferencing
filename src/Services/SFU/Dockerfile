FROM node:14
WORKDIR /app

COPY package.json .
COPY yarn.lock .
RUN yarn install

COPY . .

RUN yarn build

ENV MEDIASOUP_MIN_PORT=40000
ENV MEDIASOUP_MIN_PORT=49999
ENV MEDIASOUP_LISTEN_IP=0.0.0.0
# MEDIASOUP_ANNOUNCED_IP=???

EXPOSE 3000
EXPOSE 40000-49999

CMD [ "node", "build/index.js" ]