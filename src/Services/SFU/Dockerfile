FROM node:14
WORKDIR /app

COPY package.json .
COPY yarn.lock .
RUN yarn install

COPY . .

RUN yarn build

ENV MEDIASOUP_MIN_PORT=2000
ENV MEDIASOUP_MAX_PORT=2020
ENV MEDIASOUP_LISTEN_IP=0.0.0.0

EXPOSE 3000
EXPOSE 9000
EXPOSE 2000-2020

CMD [ "node", "build/index.js" ]